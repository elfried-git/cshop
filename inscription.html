<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription</title>
    <link rel="stylesheet" href="global.css">
    <link rel="stylesheet" href="auth.css">
</head>

<body>
    <header class="main-header">
        <div id="logo">
            <a href="index.html">
                <img src="images/assoc.png" alt="Logo de l'association">
            </a>
        </div>
        <nav class="main-nav" aria-label="Menu principal">
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="quisommesnous.html">Qui sommes-nous ?</a></li>
                <li><a href="index.html#produits-en-avant">Produits</a></li>
                <li><a href="index.html#contact">Contact</a></li>
                <li><a href="connexion.html">Profil</a></li>
                <li>
                    <a href="panier.html" class="icone-panier" aria-label="Voir le panier">
                        <img src="images/panier.png" alt="Panier" />
                        <span id="compteur-panier">0</span>
                    </a>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="auth-wrapper">
            <div id="register-form-container" class="registration-container">
                <form class="account-form" action="register.php" method="POST">
                    <h2>Créer un compte</h2>

                    <div class="form-group">
                        <label for="reg-email">Adresse e-mail</label>
                        <input type="email" id="reg-email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="reg-username">Nom d'utilisateur</label>
                        <input type="text" id="reg-username" name="username" required>
                    </div>

                    <div class="form-group">
                        <label for="reg-password">Mot de passe</label>
                        <input type="password" id="reg-password" name="password" required minlength="8">
                    </div>

                    <div class="form-group">
                        <label for="reg-confirm-password">Confirmer le mot de passe</label>
                        <input type="password" id="reg-confirm-password" name="confirm_password" required minlength="8">
                        <small id="password-match-error" style="color: red; display: none; margin-top: 5px;">Les mots de
                            passe ne correspondent!</small>
                    </div>

                    <button type="submit" class="btn-primary" id="submit-button" disabled>S'inscrire</button>

                    <div class="form-check">
                        <input type="checkbox" id="terms" name="terms" required>
                        <label for="terms">J'accepte les <a href="terms-conditions.html">Conditions
                                d'utilisation</a></label>
                    </div>

                </form>

                <script>
                    // Get the DOM elements
                    const passwordInput = document.getElementById('reg-password');
                    const confirmPasswordInput = document.getElementById('reg-confirm-password');
                    const submitButton = document.getElementById('submit-button');
                    const passwordError = document.getElementById('password-match-error');
                    // NOUVEAU : Récupération de la case à cocher
                    const termsCheckbox = document.getElementById('terms');

                    // Fonction pour vérifier si les mots de passe correspondent ET si les conditions sont acceptées
                    function checkFormValidity() {
                        const password = passwordInput.value;
                        const confirmPassword = confirmPasswordInput.value;
                        const termsAccepted = termsCheckbox.checked;

                        const passwordsMatch = password === confirmPassword && password.length >= 8;
                        const isFormValid = passwordsMatch && termsAccepted;

                        // Gérer l'état du bouton
                        submitButton.disabled = !isFormValid;

                        // Gérer l'affichage de l'erreur
                        if (password.length > 0 && confirmPassword.length > 0 && !passwordsMatch) {
                            passwordError.style.display = 'block';
                        } else {
                            passwordError.style.display = 'none';
                        }
                    }

                    // Attacher la fonction de vérification à tous les champs pertinents
                    passwordInput.addEventListener('input', checkFormValidity);
                    confirmPasswordInput.addEventListener('input', checkFormValidity);
                    // NOUVEAU : Écouteur d'événement pour la case à cocher
                    termsCheckbox.addEventListener('change', checkFormValidity);

                    // Vérification initiale au chargement de la page
                    document.addEventListener('DOMContentLoaded', checkFormValidity);
                </script>

                <p class="form-toggle-link">
                    Vous avez déjà un compte ? <a href="connexion.html">Connectez-vous ici</a>.
                </p>
            </div>
        </div>
    </main>

    <script>
        function updateCartCounter() {
            const compteur = document.getElementById("compteur-panier");
            if (compteur) {
                const panier = JSON.parse(localStorage.getItem("panier")) || [];
                const totalArticles = panier.reduce((acc, item) => acc + item.quantite, 0);
                compteur.textContent = totalArticles;
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            updateCartCounter();
        });
    </script>
</body>

</html>